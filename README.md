# kintone-scraper

kintoneå¼€å‘è€…æ–‡æ¡£æŠ“å–å™¨ - è‡ªåŠ¨æŠ“å–å¹¶æ•´ç†cybozuå¼€å‘è€…ç½‘ç«™çš„æ‰€æœ‰æŠ€æœ¯æ–‡æ¡£

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- âœ… **æ™ºèƒ½åˆ†ç±»æŠ“å–**: æŒ‰ç…§ç½‘ç«™çš„ç›®å½•å±‚çº§è‡ªåŠ¨ç»„ç»‡ä¸‹è½½çš„æ–‡æ¡£
- âœ… **å®Œæ•´å†…å®¹æå–**: æŠ“å–æ–‡ç« æ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»ã€æ›´æ–°æ—¶é—´ç­‰å®Œæ•´ä¿¡æ¯
- âœ… **ç¦»çº¿HTMLç‰ˆæœ¬**: ç”Ÿæˆå¸¦å¯¼èˆªçš„å®Œæ•´ç¦»çº¿HTMLæ–‡æ¡£ç½‘ç«™
- âœ… **å›¾ç‰‡å’Œé™„ä»¶ä¸‹è½½**: è‡ªåŠ¨ä¸‹è½½æ–‡ç« ä¸­çš„å›¾ç‰‡å’Œé™„ä»¶æ–‡ä»¶
- âœ… **æ™ºèƒ½é“¾æ¥å¤„ç†**: æ–‡ç« é—´é“¾æ¥è‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°é“¾æ¥ï¼Œå¤–éƒ¨é“¾æ¥ä¿æŒå¯ç”¨
- âœ… **åˆ†ç±»ç­›é€‰ç•Œé¢**: æ”¯æŒæ ‘çŠ¶åˆ†ç±»å¯¼èˆªå’Œæ–‡ç« ç­›é€‰åŠŸèƒ½
- âœ… **å¤šæ¨¡å¼è¿è¡Œ**: æ”¯æŒæµ‹è¯•ã€å°æ‰¹é‡ã€å…¨é‡ä¸‰ç§æŠ“å–æ¨¡å¼ï¼Œè¾“å‡ºç›®å½•åˆ†ç¦»
- âœ… **å‹å¥½æŠ“å–**: è‡ªåŠ¨æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼Œé¿å…å¯¹æœåŠ¡å™¨é€ æˆå‹åŠ›
- âœ… **è¿›åº¦è·Ÿè¸ª**: å®æ—¶æ˜¾ç¤ºæŠ“å–è¿›åº¦å’Œç»Ÿè®¡ä¿¡æ¯

## ğŸ“ é¡¹ç›®ç»“æ„

```
kintone-scraper/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ kintone_scraper/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ cli.py              # å‘½ä»¤è¡Œæ¥å£
â”‚       â”œâ”€â”€ scraper.py          # æ ¸å¿ƒæŠ“å–å™¨
â”‚       â”œâ”€â”€ image_downloader.py # å›¾ç‰‡å’Œé™„ä»¶ä¸‹è½½å™¨
â”‚       â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚       â”œâ”€â”€ utils.py            # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ run_scraper.py          # ä¸»è¿è¡Œè„šæœ¬
â”œâ”€â”€ tests/                      # å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
â”œâ”€â”€ output/                     # å®Œæ•´æŠ“å–è¾“å‡ºï¼ˆä¿ç•™ï¼‰
â”œâ”€â”€ output_test/                # æµ‹è¯•æ¨¡å¼è¾“å‡º
â”œâ”€â”€ output_small/               # å°æ‰¹é‡æ¨¡å¼è¾“å‡º
â”œâ”€â”€ output_tiny/                # å¾®å‹æ¨¡å¼è¾“å‡º
â”œâ”€â”€ output_full/                # å…¨é‡æ¨¡å¼è¾“å‡º
â”œâ”€â”€ pyproject.toml             # Poetryé…ç½®
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â””â”€â”€ pytest.ini                # æµ‹è¯•é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd kintone-scraper

# å®‰è£…ä¾èµ–
poetry install

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
poetry shell
```

### ä½¿ç”¨æ–¹æ³•

é¡¹ç›®æ”¯æŒä¸‰ç§è¿è¡Œæ¨¡å¼ï¼šæµ‹è¯•ã€å°æ‰¹é‡ã€å…¨é‡æŠ“å–ã€‚**æ¯ç§æ¨¡å¼ä¼šè‡ªåŠ¨åˆ›å»ºç‹¬ç«‹çš„è¾“å‡ºç›®å½•ï¼Œé¿å…ç›¸äº’è¦†ç›–ã€‚**

```bash
# æµ‹è¯•æ¨¡å¼ - åªæŠ“å–å°‘é‡æ–‡ç« éªŒè¯åŠŸèƒ½
# è¾“å‡ºç›®å½•: output_test/
poetry run python scripts/run_scraper.py test

# å°æ‰¹é‡æ¨¡å¼ - æŠ“å–éƒ¨åˆ†æ–‡æ¡£  
# è¾“å‡ºç›®å½•: output_small/
poetry run python scripts/run_scraper.py small

# å¾®å‹æ¨¡å¼ - æ¯ä¸ªsectionæŠ“å–1ç¯‡æ–‡ç« ï¼ˆå¿«é€Ÿæµ‹è¯•ç”¨ï¼‰
# è¾“å‡ºç›®å½•: output_tiny/
poetry run python scripts/run_scraper.py tiny

# å¾®å‹æ¨¡å¼ï¼ˆAPIé©±åŠ¨ï¼‰- æµ‹è¯•APIæ¨¡å¼çš„åˆ†ç±»é€»è¾‘
poetry run python scripts/run_scraper.py tiny --use-api

# å…¨é‡æ¨¡å¼ - æŠ“å–æ‰€æœ‰æ–‡æ¡£
# è¾“å‡ºç›®å½•: output_full/
poetry run python scripts/run_scraper.py full

# æŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆä¼šåœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºæ¨¡å¼å­ç›®å½•ï¼‰
# ä¾‹å¦‚: ./my_data/test/, ./my_data/small/, ./my_data/full/
poetry run python scripts/run_scraper.py test -o ./my_data

# å°è¯•ä¸‹è½½å¤–éƒ¨å›¾ç‰‡å’Œé™„ä»¶ï¼ˆé»˜è®¤è·³è¿‡ï¼‰
poetry run python scripts/run_scraper.py test --try-external-images

# æŸ¥çœ‹å¸®åŠ©
poetry run python scripts/run_scraper.py --help
```

### Python API

```python
from kintone_scraper import KintoneScraper

# åˆ›å»ºæŠ“å–å™¨
scraper = KintoneScraper(output_dir="./data")

# å¼€å§‹æŠ“å–
scraper.scrape_all()

# æˆ–è€…åªæŠ“å–ç‰¹å®šåˆ†ç±»
scraper.scrape_categories(["APIæ–‡æ¡£", "æ’ä»¶"])
```

## ğŸ“Š è¾“å‡ºæ ¼å¼

### ç›®å½•ç»“æ„
ä¸åŒè¿è¡Œæ¨¡å¼ä¼šåˆ›å»ºç‹¬ç«‹çš„è¾“å‡ºç›®å½•ï¼ŒæŠ“å–çš„æ–‡æ¡£ä¼šæŒ‰ç…§ç½‘ç«™çš„åˆ†ç±»å±‚çº§è¿›è¡Œç»„ç»‡ï¼š

```
output_test/          # æµ‹è¯•æ¨¡å¼è¾“å‡º
â”œâ”€â”€ html/            # HTMLæ ¼å¼æ–‡æ¡£
â”œâ”€â”€ images/          # ä¸‹è½½çš„å›¾ç‰‡
â”œâ”€â”€ attachments/     # ä¸‹è½½çš„é™„ä»¶
â””â”€â”€ scraper.log     # è¿è¡Œæ—¥å¿—

output_small/         # å°æ‰¹é‡æ¨¡å¼è¾“å‡º
â”œâ”€â”€ html/
â”‚   â”œâ”€â”€ index.html   # ä¸»é¡µé¢ï¼ˆæ”¯æŒåˆ†ç±»ç­›é€‰ï¼‰
â”‚   â”œâ”€â”€ APIæ–‡æ¡£/
â”‚   â”‚   â””â”€â”€ kintone REST API/
â”‚   â”‚       â”œâ”€â”€ 200733_kintone REST APIå…±é€šè§„æ ¼.html
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ æ’ä»¶/
â”‚   â”‚   â””â”€â”€ æ’ä»¶å¼€å‘/
â”‚   â””â”€â”€ æ–°æ‰‹æ•™ç¨‹/
â”œâ”€â”€ images/          # å›¾ç‰‡æ–‡ä»¶
â”œâ”€â”€ attachments/     # é™„ä»¶æ–‡ä»¶
â””â”€â”€ scraper.log

output_full/          # å…¨é‡æ¨¡å¼è¾“å‡ºï¼ˆå®Œæ•´æ–‡æ¡£ï¼‰
â”œâ”€â”€ html/            # æ‰€æœ‰HTMLæ–‡æ¡£
â”œâ”€â”€ images/          # æ‰€æœ‰å›¾ç‰‡
â”œâ”€â”€ attachments/     # æ‰€æœ‰é™„ä»¶
â””â”€â”€ scraper.log
```

### æ–‡ä»¶æ ¼å¼

#### Markdownæ–‡ä»¶
æ¯ç¯‡æ–‡ç« éƒ½ä¼šç”Ÿæˆä¸€ä¸ªMarkdownæ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- æ–‡ç« æ ‡é¢˜
- åˆ†ç±»ä¿¡æ¯
- æœ€åæ›´æ–°æ—¶é—´
- åŸæ–‡é“¾æ¥
- å®Œæ•´å†…å®¹

#### JSONæ•°æ®
åŒæ—¶ç”ŸæˆJSONæ ¼å¼çš„ç»“æ„åŒ–æ•°æ®ï¼š
- `complete_data.json` - å®Œæ•´çš„æŠ“å–æ•°æ®
- `articles_index.json` - æ–‡ç« ç´¢å¼•
- `categories.json` - åˆ†ç±»ç»“æ„

## âš™ï¸ é…ç½®é€‰é¡¹

å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æˆ–å‘½ä»¤è¡Œå‚æ•°è‡ªå®šä¹‰æŠ“å–è¡Œä¸ºï¼š

```python
# config.py
BASE_URL = "https://cybozudev.kf5.com/hc/"
REQUEST_DELAY = 0.5  # è¯·æ±‚é—´éš”ï¼ˆç§’ï¼‰
TIMEOUT = 30         # è¯·æ±‚è¶…æ—¶æ—¶é—´
MAX_RETRIES = 3      # æœ€å¤§é‡è¯•æ¬¡æ•°
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
poetry run pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
poetry run pytest tests/test_scraper.py

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
poetry run pytest --cov=kintone_scraper
```

## ğŸ“ å¼€å‘

### ä»£ç æ ¼å¼åŒ–
```bash
# æ ¼å¼åŒ–ä»£ç 
poetry run black src/ tests/
poetry run isort src/ tests/

# ç±»å‹æ£€æŸ¥
poetry run mypy src/
```

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `src/kintone_scraper/` ä¸‹æ·»åŠ æ–°æ¨¡å—
2. ç¼–å†™ç›¸åº”çš„æµ‹è¯•
3. æ›´æ–°æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## âš ï¸ æ³¨æ„äº‹é¡¹

- è¯·éµå®ˆç½‘ç«™çš„robots.txtå’Œä½¿ç”¨æ¡æ¬¾
- å»ºè®®åœ¨éé«˜å³°æœŸè¿è¡Œï¼Œé¿å…å¯¹æœåŠ¡å™¨é€ æˆè¿‡å¤§å‹åŠ›
- å¦‚æœç½‘ç«™ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œå¯èƒ½éœ€è¦æ›´æ–°é€‰æ‹©å™¨é…ç½®

## ğŸ¯ é¡¹ç›®çŠ¶æ€

**å½“å‰ç‰ˆæœ¬**: åŠŸèƒ½å®Œå–„ç‰ˆæœ¬ âœ¨

- âœ… æ ¸å¿ƒæŠ“å–åŠŸèƒ½å®Œæ•´
- âœ… HTMLç¦»çº¿ç‰ˆæœ¬æ”¯æŒ
- âœ… å›¾ç‰‡å’Œé™„ä»¶ä¸‹è½½
- âœ… æ™ºèƒ½é“¾æ¥å¤„ç†
- âœ… åˆ†ç±»å¯¼èˆªç•Œé¢
- âœ… å¤šæ¨¡å¼è¿è¡Œæ”¯æŒ
- âœ… å®Œæ•´çš„ç”¨æˆ·æ–‡æ¡£

é¡¹ç›®å·²ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œå¯ä»¥ç¨³å®šè¿è¡Œã€‚æ‰€æœ‰ä¸»è¦åŠŸèƒ½éƒ½å·²å®ç°å¹¶ç»è¿‡éªŒè¯ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–è”ç³»ç»´æŠ¤è€…ã€‚

