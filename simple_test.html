<!DOCTYPE html>
<html>
<head>
    <title>简单测试</title>
</head>
<body>
    <h1>测试代码块识别</h1>

    <div>这是普通的文本<pre>普通的文本内容</pre></div>

    <div>这是JSON代码<pre>{"key": "value", "array": [1, 2, 3]}</pre></div>

    <div>这是JavaScript代码<pre>function test() { console.log("Hello"); }</pre></div>

    <script>
    function isCodePre(pre) {
        if (!pre || pre.tagName !== 'PRE') return false;
        if (pre.querySelector('code')) return true;
        var cls = (pre.getAttribute('class') || '').toLowerCase();
        if (/(brush:|language-|lang-|code)/.test(cls)) return true;

        // Check if pre contains code-like content (JSON, JavaScript, etc.)
        var text = pre.textContent || pre.innerText || '';
        // Check for common code patterns: {, }, [, ], function, var, const, let, etc.
        return /[{}\[\]]/.test(text) || /\b(function|var|const|let|if|for|while)\b/.test(text);
    }

    // Test all pre tags
    var pres = document.getElementsByTagName('pre');
    console.log('找到的pre标签数量:', pres.length);

    for (var i = 0; i < pres.length; i++) {
        var pre = pres[i];
        var content = pre.textContent || pre.innerText || '';
        console.log('Pre标签', i, ':', content.substring(0, 50));
        console.log('  是否包含大括号:', /[{}\[\]]/.test(content));
        console.log('  是否包含关键词:', /\b(function|var|const|let|if|for|while)\b/.test(content));
        console.log('  是否识别为代码块:', isCodePre(pre));
    }
    </script>
</body>
</html>




